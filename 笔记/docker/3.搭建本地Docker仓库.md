搭建本地 Docker 仓库

一、创建仓库

下载镜像
```shell
   docker pull registry
```

创建容器并启动
```shell
docker run -d -p 5000:5000 -v /opt/data/registry:/usr/local/docker/registry registry
```
验证仓库是否启动成功
```shell
docker ps -a
```
浏览器访问
```shell
http://192.168.0.103:5000/v2/_catalog
```

```yaml
version: '3.1'
services:
  registry:
    image: registry
    restart: always
    container_name: registry
    ports:
      - 5000:5000
    volumes:
      - ./data:/var/lib/registry
```


二、配置仓库
vi /etc/docker/daeon.json
```shell
{
"registry-mirrors" : [ "https://docker.mirrors.ustc.edu.cn" ],
"insecure-registries":["192.168.1.130:5000"]
}
```

重启docker服务
```shell
systemctl restart docker
```

上传镜像
容器打成镜像
```shell
docker commit -m "说明文字" -a "作者" 容器ID 新的镜像名
```
打标签
```shell
docker tag 本地镜像名 标签名
```
上传
```shell
docker push 192.168.0.130:5000/标签名
```
查看
```shell
http://192.168.0.130:5000/v2/_catalog
```







